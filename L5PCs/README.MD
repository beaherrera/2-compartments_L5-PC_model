This folder contains the model codes without including Ih (noIh) and including Ih (Ih) for a collaction of L5-PCs located randomly in a cortical column.

Before running scripts, please **add [InputCurrents](/InputCurrents) and [IonicCurrents](/IonicCurrents) to the MATLAB path.**
To solve each case, please run:
- [mainIh.m](mainIh.m) for Ih present, and
- [mainNoIh.m](mainNoIh.m) for Ih absent.

In these scripts, you will find the following stimulations paradigms:
- *const_current:* when selected -> Somatic input current is a current step pulse, whereas the dendritic input can be either a current step pulse or a double exponential. You can specify the amplitude of both stimulations as well as the duration of the square pulse by defining the stimulation onset and stimulation end. To apply an EPSP-like current or double exponential current to the dendritic compartment, set the stimulation end as 0ms. Dendritic stimulation will start at the time set by the stimulation onset. Please read comments on the codes for more details. These stimulation paradigms were used to study the BAC-firing property shown by these neurons.
- *pulse_train:*  when selected -> the somatic/dendritic input is a train of square pulses. You can specify their duration, amplitude, and frequency. You can also set a time window for the stimulation -> stimulation onset and end. This type of stimulation was used to study the influence of the somatic APs frequency on the dendritic Ca2+ spike generation.   
- *noisy_current*: the somatic input current is a noisy current with constant mean and standard deviation. Stimulus-type used in the paper to generate the LFPs and CSD maps.
- *noisy staircase current:* when none of the above is selected, a noisy staircase current is applied to the somatic/dendritic compartments. These in vivo-like input currents are generated using the Ornstein-Uhlenbeck method. You can specify its mean, standard deviation, step duration, and step length. You can also choose the compartment in which you want to apply the current. This type of stimulation was used to generate the f-I curve for either somatic or dendritic stimulations.

You can also specify the number of neurons and trials at the beginning of the scripts, as well as the simulation time.

At the end of each script, the functions [lfp_calculation.m](lfp_calculation.m) and [iCSD_Pettersen.m](iCSD_Pettersen.m) are called. The first one computes the LFPs evoked by the activity of the collection of L5-PCs. The second one calculates the CSD maps generated by the estimated LFPs. The function [lfp_pointSourceMethod.m](lfp_pointSourceMethod.m) computes the extracellular potentials using the Point Source Approximation.

All parameters in the codes are the ones used to perform the simulations in the present study. Simulation's results are stored in a folder named FiguresData inside the folder called GenerateFigures.
